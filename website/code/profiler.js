const PROFILER_CODE =
  '(async()=>{let t=1,n=[];const e=new PerformanceObserver(e=>{const o=e.getEntries();for(const e of o)n.push({id:`${t}`,name:e.name,start:Math.round(e.startTime),end:Math.round(e.startTime+e.duration),duration:Math.round(e.duration)}),t++});e.observe({type:"longtask"});const o=await performance.profile({categories:["js"],sampleInterval:1,sampleBufferSize:Number.MAX_SAFE_INTEGER});async function r(){e.disconnect();const t=function(t){const e={};for(const o of t.samples){const r=Math.round(o.timestamp);for(const a of n){const{start:n,name:c,id:i,end:u,duration:f}=a;if(r>=n&&r<=u){e[i]||(e[i]={name:c,start:n,end:u,duration:f,culprits:[]});const a=s(t,o.stackId);e[i].culprits.push({time:r,stackId:o.stackId,stack:a})}}}return function(t,n){Object.keys(t).forEach(e=>{const{culprits:o,start:r,end:a}=t[e],s=[];let i=r;for(let t=0,e=1;e<o.length+1;t++,e++){let r=o[t],u=o[e];for(;u&&u.stackId===r.stackId;)e++,r=o[++t],u=o[e];const f=e===o.length,d=f?r.time-i+(a-r.time):r.time-i;s.push({totalTime:d,frames:c(n,r.stack)}),i=r.time}t[e].culprits=s})}(e,t),e}(await o.stop());try{const n="https://rum-profiler.now.sh",e=`${n}/flamegraph`,o=await fetch(e,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t),mode:"cors",redirect:"follow"}),r=`${n}/trace/${await o.text()}`;console.log("%c Open this link in new tab to see the profiler data - "+r,"color: red"),window.open(r,"_blank")}catch(t){console.error("Failed to generate flamegraphs data because of an error",t)}}function a(t,n){return function(t,n){let{name:e,line:o,column:r,resourceId:a}=n;if(!e&&!o&&!r)return"unknown";e||(e="anonymous");if(!o||!r)return`${e} (native code)`;const s=function(t,n){return t.resources[n]}(t,a);return`${e} (${s}:${o}:${r})`}(t,function(t,n){return t.frames[n]}(t,n.frameId))}function s(t,n){return t.stacks[n]}function c(t,n,e=[]){if(!n)return e;const{parentId:o}=n;if(null!=o){return e.unshift(a(t,n)),c(t,s(t,o),e)}return e.unshift(a(t,n)),e}window.addEventListener("load",()=>r())})()';

export default PROFILER_CODE;
